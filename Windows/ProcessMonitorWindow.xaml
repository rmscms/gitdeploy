<mah:MetroWindow x:Class="GitDeployPro.Windows.ProcessMonitorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
        mc:Ignorable="d"
        Title="Database Process Monitor"
        Height="520"
        Width="960"
        WindowStartupLocation="CenterOwner"
        Background="#1E1E1E"
        Foreground="#F0F0F0">

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Connection controls -->
        <Border Grid.Row="0"
                Background="#26272B"
                CornerRadius="8"
                Padding="14"
                BorderBrush="#3A3B40"
                BorderThickness="1">
            <StackPanel>
                <TextBlock Text="Select a database connection"
                           FontSize="13"
                           Foreground="#BBBBBB"
                           Margin="0,0,0,8"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <ComboBox x:Name="ConnectionsCombo"
                              Grid.Column="0"
                              Height="32"
                              DisplayMemberPath="Name"
                              SelectionChanged="ConnectionsCombo_SelectionChanged"/>

                    <Button x:Name="ReloadConnectionsButton"
                            Grid.Column="1"
                            Content="ðŸ”„"
                            Width="36"
                            Height="32"
                            Margin="8,0,0,0"
                            ToolTip="Reload saved connections"
                            Click="ReloadConnectionsButton_Click"
                            Background="#3A3B40"
                            Foreground="White"
                            BorderThickness="0"/>

                    <Button x:Name="ConnectButton"
                            Grid.Column="2"
                            Content="Connect"
                            Height="32"
                            Margin="8,0,0,0"
                            Padding="18,0"
                            Background="#3F8EF7"
                            Foreground="White"
                            BorderThickness="0"
                            Click="ConnectButton_Click"/>

                    <Button x:Name="RefreshButton"
                            Grid.Column="3"
                            Content="Refresh list"
                            Height="32"
                            Margin="8,0,0,0"
                            Padding="18,0"
                            Background="#3A3B40"
                            Foreground="White"
                            BorderThickness="0"
                            Click="RefreshButton_Click"/>

                    <StackPanel Grid.Column="4"
                                Orientation="Horizontal"
                                Margin="12,0,0,0"
                                VerticalAlignment="Center">
                        <TextBlock Text="Auto-refresh:"
                                   Foreground="#BBBBBB"
                                   Margin="0,0,6,0"
                                   VerticalAlignment="Center"/>
                        <ComboBox x:Name="IntervalCombo"
                                  Width="130"
                                  Height="28"
                                  SelectionChanged="IntervalCombo_SelectionChanged">
                            <ComboBoxItem Content="Off" Tag="0" IsSelected="True"/>
                            <ComboBoxItem Content="5 seconds" Tag="5"/>
                            <ComboBoxItem Content="10 seconds" Tag="10"/>
                            <ComboBoxItem Content="30 seconds" Tag="30"/>
                            <ComboBoxItem Content="60 seconds" Tag="60"/>
                        </ComboBox>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Process list -->
        <Border Grid.Row="1"
                Margin="0,16,0,16"
                Background="#1B1C1F"
                CornerRadius="10"
                BorderBrush="#2F3034"
                BorderThickness="1">
            <DataGrid x:Name="ProcessGrid"
                      AutoGenerateColumns="False"
                      HeadersVisibility="Column"
                      GridLinesVisibility="Horizontal"
                      Background="Transparent"
                      Foreground="#FFFFFF"
                      BorderThickness="0"
                      RowBackground="#1F2023"
                      AlternatingRowBackground="#2A2B30"
                      IsReadOnly="True">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="70"/>
                    <DataGridTextColumn Header="User" Binding="{Binding User}" Width="140"/>
                    <DataGridTextColumn Header="Host" Binding="{Binding Host}" Width="180"/>
                    <DataGridTextColumn Header="Database" Binding="{Binding Database}" Width="120"/>
                    <DataGridTextColumn Header="Command" Binding="{Binding Command}" Width="120"/>
                    <DataGridTextColumn Header="Time (s)" Binding="{Binding TimeSeconds}" Width="80"/>
                    <DataGridTextColumn Header="State" Binding="{Binding State}" Width="160"/>
                    <DataGridTextColumn Header="Info" Binding="{Binding Info}" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <!-- Status -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" VerticalAlignment="Center">
            <ProgressBar x:Name="BusyBar"
                         Width="180"
                         Height="6"
                         Visibility="Collapsed"
                         IsIndeterminate="True"/>
            <TextBlock x:Name="StatusText"
                       Margin="12,0,0,0"
                       Foreground="#CFCFCF"
                       VerticalAlignment="Center"
                       Text="Choose a connection to get started."/>
        </StackPanel>
    </Grid>
</mah:MetroWindow>


